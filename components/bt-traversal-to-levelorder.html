<!-- ===============================
 Traversal → Level Order Converter
=============================== -->
<section class="bt-t2l-root">
  <h2 class="bt-title">Traversal → Level Order</h2>
  <p class="bt-subtitle">
    Convert traversal inputs directly into a level-order array usable by the visualizer.
  </p>

  <div class="bt-box">

    <!-- MODE -->
    <div class="bt-row">
      <label class="bt-radio">
        <input type="radio" name="btMode" value="pre" checked>
        Preorder + Inorder
      </label>
      <label class="bt-radio">
        <input type="radio" name="btMode" value="post">
        Postorder + Inorder
      </label>
    </div>

    <!-- INPUTS -->
    <div class="bt-grid">
      <div>
        <label>Traversal</label>
        <textarea id="btPrimary" placeholder="[A,B,D,C]"></textarea>
      </div>

      <div>
        <label>Inorder (Required)</label>
        <textarea id="btInorder" placeholder="[D,B,A,C]"></textarea>
      </div>
    </div>

    <!-- ACTIONS -->
    <div class="bt-actions">
      <button id="btConvert">Convert</button>
      <button class="ghost" id="btClear">Clear</button>
    </div>

    <!-- ERROR -->
    <div id="btError" class="bt-error"></div>

    <!-- OUTPUT -->
    <div class="bt-output">
      <label>Level Order Output</label>
      <pre id="btResult">[ ]</pre>
      <button id="btCopy" disabled>Copy</button>
    </div>

  </div>
</section>

<style>
.bt-t2l-root {
  padding: 80px 20px;
  max-width: 1200px;
  margin: auto;
  font-family: system-ui, sans-serif;
}

.bt-title {
  font-size: 2rem;
  font-weight: 800;
  margin-bottom: 6px;
}

.bt-subtitle {
  color: #9ca3af;
  margin-bottom: 28px;
}

.bt-box {
  background: rgba(15, 23, 42, 0.75);
  border: 1px solid rgba(148,163,184,0.25);
  border-radius: 22px;
  padding: 28px;
  box-shadow: 0 40px 90px rgba(0,0,0,0.45);
}

.bt-row {
  display: flex;
  gap: 20px;
  margin-bottom: 24px;
}

.bt-radio {
  background: rgba(2,6,23,0.8);
  padding: 10px 16px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.3);
  cursor: pointer;
}

.bt-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.bt-grid label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
}

.bt-grid textarea {
  width: 100%;
  min-height: 90px;
  background: #020617;
  color: #e5e7eb;
  border: 1px solid #1f2937;
  border-radius: 14px;
  padding: 14px;
  font-size: 0.95rem;
}

.bt-actions {
  margin-top: 24px;
  display: flex;
  gap: 14px;
}

.bt-actions button {
  padding: 12px 20px;
  border-radius: 12px;
  border: none;
  font-weight: 700;
  cursor: pointer;
  background: linear-gradient(135deg,#6366f1,#4f46e5);
  color: #fff;
}

.bt-actions .ghost {
  background: transparent;
  border: 1px solid #334155;
  color: #cbd5f5;
}

.bt-error {
  margin-top: 16px;
  color: #f87171;
  font-weight: 600;
}

.bt-output {
  margin-top: 30px;
}

.bt-output pre {
  background: #020617;
  border: 1px solid #1f2937;
  border-radius: 14px;
  padding: 16px;
  color: #a5b4fc;
  font-size: 0.95rem;
  overflow-x: auto;
}

.bt-output button {
  margin-top: 12px;
  padding: 10px 16px;
  border-radius: 10px;
  border: none;
  background: #22c55e;
  color: #022c22;
  font-weight: 800;
  cursor: pointer;
}

.bt-output button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

/* ===== Industry Mode ===== */
body.industry-mode .bt-box {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  box-shadow: none;
}

body.industry-mode .bt-grid textarea,
body.industry-mode .bt-output pre {
  background: #f9fafb;
  color: #111827;
  border: 1px solid #e5e7eb;
}

body.industry-mode .bt-radio {
  background: #f9fafb;
}
</style>

<script>
(function () {
  const primary = document.getElementById("btPrimary");
  const inorder = document.getElementById("btInorder");
  const result = document.getElementById("btResult");
  const error = document.getElementById("btError");
  const copyBtn = document.getElementById("btCopy");

  function parseArr(v) {
    try {
      const s = v.replace(/\bnull\b/gi,"null");
      const a = JSON.parse(s);
      return Array.isArray(a) ? a : null;
    } catch { return null; }
  }

  function build(pre, ino) {
    if (!pre.length) return null;
    const root = pre[0];
    const i = ino.indexOf(root);
    if (i === -1) throw "Mismatch";
    return {
      v: root,
      l: build(pre.slice(1,i+1), ino.slice(0,i)),
      r: build(pre.slice(i+1), ino.slice(i+1))
    };
  }

  function bfs(root) {
    const q=[root], out=[];
    while(q.length){
      const n=q.shift();
      if(!n){ out.push(null); continue; }
      out.push(n.v);
      q.push(n.l, n.r);
    }
    while(out[out.length-1]===null) out.pop();
    return out;
  }

  document.getElementById("btConvert").onclick = () => {
    error.textContent="";
    const p=parseArr(primary.value);
    const i=parseArr(inorder.value);
    if(!p||!i) return error.textContent="Invalid array input.";
    if(p.length!==i.length) return error.textContent="Lengths must match.";
    try{
      const tree=build(p,i);
      const arr=bfs(tree);
      result.textContent=JSON.stringify(arr);
      copyBtn.disabled=false;
    }catch{
      error.textContent="Traversals do not describe the same tree.";
    }
  };

  document.getElementById("btClear").onclick=()=>{
    primary.value=inorder.value="";
    result.textContent="[ ]";
    error.textContent="";
    copyBtn.disabled=true;
  };

  copyBtn.onclick=()=>{
    navigator.clipboard.writeText(result.textContent);
    copyBtn.textContent="Copied";
    setTimeout(()=>copyBtn.textContent="Copy",1200);
  };
})();
</script>
